import{r as h,j as e,P as c,B as u,T as d,v as y}from"./index-DzEDZhAG.js";import{u as R}from"./index-Dcr2Tpvq.js";import{T,a as O,b as S,c as j,d as m,e as D,E}from"./exceljs.min-Vyz3t8eE.js";import{C as B}from"./CircularProgress-zyFti9yw.js";import"./index-TdFRlV01.js";import"./index-Chjiymov.js";import"./_commonjs-dynamic-modules-TDtrdbi3.js";function I(){const[r,f]=h.useState(null),[x,n]=h.useState(!1),b=async t=>{n(!0);const o=t[0];if(!o)return;const a=new FileReader;a.onload=async s=>{try{const l=JSON.parse(s.target.result);f(l)}catch{alert("Failed to parse JSON file")}n(!1)},a.readAsText(o)},{getRootProps:g,getInputProps:w}=R({onDrop:b,accept:{"application/json":[".json"]},multiple:!1}),v=async()=>{if(!r)return;n(!0);const t=new E.Workbook,o=t.addWorksheet("Sheet 1"),a=Object.keys(r[0]);o.addRow(a),r.forEach(k=>{o.addRow(Object.values(k))});const s=await t.xlsx.writeBuffer(),l=new Blob([s],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),p=URL.createObjectURL(l),i=document.createElement("a");i.href=p,i.download="data.xlsx",i.click(),URL.revokeObjectURL(p),n(!1)};return e.jsx(c,{elevation:4,sx:{borderRadius:2,p:3,boxShadow:"0px 4px 12px rgba(0, 0, 0, 0.1)",transition:"all 0.3s ease-in-out",":hover":{boxShadow:"0px 6px 16px rgba(0, 0, 0, 0.2)"}},children:e.jsxs(u,{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",width:"100%",children:[e.jsx(d,{variant:"h4",gutterBottom:!0,children:"JSON to Excel Converter"}),e.jsxs(c,{...g(),sx:{padding:4,textAlign:"center",border:"2px dashed #1976d2",borderRadius:2,width:"100%",cursor:"pointer",backgroundColor:"#f9f9f9"},children:[e.jsx("input",{...w()}),e.jsx(d,{variant:"body1",children:"Drag & drop a JSON file here, or click to select a file"})]}),x&&e.jsx(B,{sx:{marginY:2}}),r&&!x&&e.jsxs(e.Fragment,{children:[e.jsxs(u,{sx:{marginY:2,width:"100%"},children:[e.jsx(d,{variant:"h6",gutterBottom:!0,children:"Preview Data:"}),e.jsx(T,{component:c,elevation:4,children:e.jsxs(O,{children:[e.jsx(S,{children:e.jsx(j,{children:Object.keys(r[0]).map(t=>e.jsx(m,{children:t},t))})}),e.jsx(D,{children:r.slice(0,5).map((t,o)=>e.jsx(j,{children:Object.values(t).map((a,s)=>e.jsx(m,{children:a},s))},o))})]})})]}),e.jsx(y,{variant:"contained",color:"primary",sx:{marginTop:2},onClick:v,children:"Download Excel"})]})]})})}export{I as default};
