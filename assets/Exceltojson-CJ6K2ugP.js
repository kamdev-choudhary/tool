import{r as p,j as e,P as i,B as u,T as c,v as E}from"./index-DzEDZhAG.js";import{u as O}from"./index-Dcr2Tpvq.js";import{T as J,a as L,b as P,c as h,d as m,e as U,E as A}from"./exceljs.min-Vyz3t8eE.js";import{C as I}from"./CircularProgress-zyFti9yw.js";import"./index-TdFRlV01.js";import"./index-Chjiymov.js";import"./_commonjs-dynamic-modules-TDtrdbi3.js";function q(){const[a,j]=p.useState(null),[f,d]=p.useState(!1),b=async o=>{d(!0);const r=o[0];if(!r)return;const s=new A.Workbook,t=new FileReader;t.onload=async k=>{const y=k.target.result;await s.xlsx.load(y);const R=s.worksheets[0],x=[];R.eachRow(l=>{const n=l.values.slice(1);x.push(n)});const[T,...D]=x,S=D.map(l=>T.reduce((n,B,C)=>(n[B]=l[C],n),{}));j(S),d(!1)},t.readAsArrayBuffer(r)},{getRootProps:g,getInputProps:w}=O({onDrop:b,accept:{"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":[".xlsx"],"application/vnd.ms-excel":[".xls"]},multiple:!1}),v=()=>{if(!a)return;const o=JSON.stringify(a,null,2),r=new Blob([o],{type:"application/json"}),s=URL.createObjectURL(r),t=document.createElement("a");t.href=s,t.download="data.json",t.click(),URL.revokeObjectURL(s)};return e.jsx(i,{elevation:4,sx:{borderRadius:2,p:3,boxShadow:"0px 4px 12px rgba(0, 0, 0, 0.1)",transition:"all 0.3s ease-in-out",":hover":{boxShadow:"0px 6px 16px rgba(0, 0, 0, 0.2)"}},children:e.jsxs(u,{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",width:"100%",children:[e.jsx(c,{variant:"h4",gutterBottom:!0,children:"Excel to JSON Converter"}),e.jsxs(i,{...g(),sx:{padding:4,textAlign:"center",border:"2px dashed #1976d2",borderRadius:2,width:"100%",cursor:"pointer",backgroundColor:"#f9f9f9"},children:[e.jsx("input",{...w()}),e.jsx(c,{variant:"body1",children:"Drag & drop an Excel file here, or click to select a file"})]}),f&&e.jsx(I,{sx:{marginY:2}}),a&&e.jsxs(e.Fragment,{children:[e.jsxs(u,{sx:{marginTop:2,maxWidth:"100%",overflowX:"auto",p:1},children:[e.jsx(c,{variant:"h6",gutterBottom:!0,children:"Preview Data:"}),e.jsx(J,{component:i,elevation:4,children:e.jsxs(L,{children:[e.jsx(P,{children:e.jsx(h,{children:Object.keys(a[0]).map(o=>e.jsx(m,{children:o},o))})}),e.jsx(U,{children:a.slice(0,5).map((o,r)=>e.jsx(h,{children:Object.values(o).map((s,t)=>e.jsx(m,{children:s},t))},r))})]})})]}),e.jsx(E,{variant:"contained",color:"primary",sx:{marginTop:2},onClick:v,children:"Download JSON"})]})]})})}export{q as default};
